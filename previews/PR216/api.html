<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>EasyHybrid.jl</title>
    <meta name="description" content="Documentation for EasyHybrid.jl">
    <meta name="generator" content="VitePress v1.6.4">
    <link rel="preload stylesheet" href="/EasyHybrid.jl/previews/PR216/assets/style.CnlJoEeq.css" as="style">
    <link rel="preload stylesheet" href="/EasyHybrid.jl/previews/PR216/vp-icons.css" as="style">
    
    <script type="module" src="/EasyHybrid.jl/previews/PR216/assets/app.CsWwZlKc.js"></script>
    <link rel="preload" href="/EasyHybrid.jl/previews/PR216/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/EasyHybrid.jl/previews/PR216/assets/chunks/theme.k4Vjdurw.js">
    <link rel="modulepreload" href="/EasyHybrid.jl/previews/PR216/assets/chunks/framework.DsnTHbsU.js">
    <link rel="modulepreload" href="/EasyHybrid.jl/previews/PR216/assets/api.md.BttXPYMS.lean.js">
    <link rel="icon" href="/EasyHybrid.jl/previews/PR216/favicon.ico">
    <script src="/EasyHybrid.jl/versions.js"></script>
    <script src="/EasyHybrid.jl/previews/PR216/siteinfo.js"></script>
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-a9a9e638><!--[--><!--]--><!--[--><span tabindex="-1" data-v-492508fc></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-492508fc>Skip to content</a><!--]--><!----><header class="VPNav" data-v-a9a9e638 data-v-f1e365da><div class="VPNavBar" data-v-f1e365da data-v-822684d1><div class="wrapper" data-v-822684d1><div class="container" data-v-822684d1><div class="title" data-v-822684d1><div class="VPNavBarTitle has-sidebar" data-v-822684d1 data-v-0f4f798b><a class="title" href="/EasyHybrid.jl/previews/PR216/" data-v-0f4f798b><!--[--><!--]--><!--[--><img class="VPImage logo" src="/EasyHybrid.jl/previews/PR216/logo_sq.png" width="24" height="24" alt data-v-35a7d0b8><!--]--><span data-v-0f4f798b>EasyHybrid.jl</span><!--[--><!--]--></a></div></div><div class="content" data-v-822684d1><div class="content-body" data-v-822684d1><!--[--><!--]--><div class="VPNavBarSearch search" data-v-822684d1><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-822684d1 data-v-e6d46098><span id="main-nav-aria-label" class="visually-hidden" data-v-e6d46098> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/EasyHybrid.jl/previews/PR216/index" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/EasyHybrid.jl/previews/PR216/get_started" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>Get Started</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-e6d46098 data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><!----><span data-v-04f5c5e9>Tutorial</span><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/EasyHybrid.jl/previews/PR216/tutorials/exponential_res" data-v-acbfed09><!--[--><span data-v-acbfed09>Exponential Response</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/EasyHybrid.jl/previews/PR216/tutorials/hyperparameter_tuning" data-v-acbfed09><!--[--><span data-v-acbfed09>Hyperparameter Tuning</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/EasyHybrid.jl/previews/PR216/tutorials/slurm" data-v-acbfed09><!--[--><span data-v-acbfed09>Slurm</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/EasyHybrid.jl/previews/PR216/tutorials/folds" data-v-acbfed09><!--[--><span data-v-acbfed09>Cross-validation</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/EasyHybrid.jl/previews/PR216/tutorials/losses" data-v-acbfed09><!--[--><span data-v-acbfed09>Loss Functions</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-e6d46098 data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><!----><span data-v-04f5c5e9>Research</span><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/EasyHybrid.jl/previews/PR216/research/overview" data-v-acbfed09><!--[--><span data-v-acbfed09>Overview</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink active" href="/EasyHybrid.jl/previews/PR216/api" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>API</span><!--]--></a><!--]--><!--[--><!----><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-822684d1 data-v-af096f4a><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-af096f4a data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-822684d1 data-v-164c457f data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/EarthyScience/EasyHybrid.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-822684d1 data-v-925effce data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-04f5c5e9><span class="vpi-more-horizontal icon" data-v-04f5c5e9></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><!----><!--[--><!--[--><!----><div class="group" data-v-925effce><div class="item appearance" data-v-925effce><p class="label" data-v-925effce>Appearance</p><div class="appearance-action" data-v-925effce><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-925effce data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div></div></div><div class="group" data-v-925effce><div class="item social-links" data-v-925effce><div class="VPSocialLinks social-links-list" data-v-925effce data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/EarthyScience/EasyHybrid.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--[--><!--[--><div class="VPFlyout VPNolebaseEnhancedReadabilitiesMenu VPNolebaseEnhancedReadabilitiesMenuFlyout" aria-label="Enhanced Readability" role="menuitem" data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><span class="i-icon-park-outline:book-open option-icon" data-v-04f5c5e9></span><!----><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><!----><!--[--><!--]--></div></div></div><!--]--><!--]--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-822684d1 data-v-5dea55bf><span class="container" data-v-5dea55bf><span class="top" data-v-5dea55bf></span><span class="middle" data-v-5dea55bf></span><span class="bottom" data-v-5dea55bf></span></span></button></div></div></div></div><div class="divider" data-v-822684d1><div class="divider-line" data-v-822684d1></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-a9a9e638 data-v-070ab83d><div class="container" data-v-070ab83d><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-070ab83d><span class="vpi-align-left menu-icon" data-v-070ab83d></span><span class="menu-text" data-v-070ab83d>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-070ab83d data-v-168ddf5d><button data-v-168ddf5d>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-a9a9e638 data-v-18756405><div class="curtain" data-v-18756405></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-18756405><span class="visually-hidden" id="sidebar-aria-label" data-v-18756405> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0" data-v-9e426adc data-v-a4b0d9bf><!----><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/EasyHybrid.jl/previews/PR216/index" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Home</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/EasyHybrid.jl/previews/PR216/get_started" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Get Started</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible" data-v-9e426adc data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h2 class="text" data-v-a4b0d9bf>Tutorial</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/EasyHybrid.jl/previews/PR216/tutorials/exponential_res" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Exponential Response</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/EasyHybrid.jl/previews/PR216/tutorials/hyperparameter_tuning" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Hyperparameter Tuning</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/EasyHybrid.jl/previews/PR216/tutorials/slurm" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Slurm</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/EasyHybrid.jl/previews/PR216/tutorials/folds" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Cross-validation</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/EasyHybrid.jl/previews/PR216/tutorials/losses" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Loss Functions</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible" data-v-9e426adc data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h2 class="text" data-v-a4b0d9bf>Research</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/EasyHybrid.jl/previews/PR216/research/overview" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Overview</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 has-active" data-v-9e426adc data-v-a4b0d9bf><!----><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/EasyHybrid.jl/previews/PR216/api" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>API</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-a9a9e638 data-v-91765379><div class="VPDoc has-sidebar has-aside" data-v-91765379 data-v-83890dd9><!--[--><!--]--><div class="container" data-v-83890dd9><div class="aside" data-v-83890dd9><div class="aside-curtain" data-v-83890dd9></div><div class="aside-container" data-v-83890dd9><div class="aside-content" data-v-83890dd9><div class="VPDocAside" data-v-83890dd9 data-v-6d7b3c46><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-6d7b3c46 data-v-b38bf2ff><div class="content" data-v-b38bf2ff><div class="outline-marker" data-v-b38bf2ff></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-b38bf2ff>On this page</div><ul class="VPDocOutlineItem root" data-v-b38bf2ff data-v-3f927ebe><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-6d7b3c46></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-83890dd9><div class="content-container" data-v-83890dd9><!--[--><!--]--><main class="main" data-v-83890dd9><div style="position:relative;" class="vp-doc _EasyHybrid_jl_previews_PR216_api" data-v-83890dd9><div><h1 id="EasyHybrid.jl" tabindex="-1">EasyHybrid.jl <a class="header-anchor" href="#EasyHybrid.jl" aria-label="Permalink to &quot;EasyHybrid.jl {#EasyHybrid.jl}&quot;">​</a></h1><p>Documentation for <code>EasyHybrid.jl</code>.</p><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.EasyHybrid" href="#EasyHybrid.EasyHybrid"><span class="jlbinding">EasyHybrid.EasyHybrid</span></a> <span class="VPBadge info jlObjectType jlModule"><!--[-->Module<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">EasyHybrid</span></span></code></pre></div><p>EasyHybrid is a Julia package for hybrid machine learning models, combining neural networks and traditional statistical methods. It provides tools for data preprocessing, model training, and evaluation, making it easier to build and deploy hybrid models.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.HybridParams" href="#EasyHybrid.HybridParams"><span class="jlbinding">EasyHybrid.HybridParams</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">HybridParams{M</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>A little parametric stub for “the params of function <code>M</code>.” All of your function‐based models become <code>HybridParams{typeof(f)}</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.LinearHM" href="#EasyHybrid.LinearHM"><span class="jlbinding">EasyHybrid.LinearHM</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LinearHM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(NN, predictors, forcing, targets, β)</span></span></code></pre></div><p>A linear hybrid model with a neural network <code>NN</code>, <code>predictors</code>, <code>forcing</code> and <code>targets</code> terms.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.LinearHM-Tuple{Any, Any, NamedTuple}" href="#EasyHybrid.LinearHM-Tuple{Any, Any, NamedTuple}"><span class="jlbinding">EasyHybrid.LinearHM</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LinearHM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(NN, predictors, forcing, β)(ds_k)</span></span></code></pre></div><p><strong>Model definition <code>ŷ = α x + β</code></strong></p><p>Apply the linear hybrid model to the input data <code>ds_k</code> (a <code>KeyedArray</code> with proper dimensions). The model uses the neural network <code>NN</code> to compute new <code>α</code>&#39;s based on the <code>predictors</code> and then computes <code>ŷ</code> using the <code>forcing</code> term <code>x</code>.</p><p>Returns:</p><p>A tuple containing the predicted values <code>ŷ</code> and a named tuple with the computed values of <code>α</code> and the state <code>st</code>.</p><p><strong>Example:</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Lux</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> EasyHybrid</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Random</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> AxisKeys</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ds_k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> KeyedArray</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">rand</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Float32, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">); data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:b</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:c</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], sample</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">m </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Lux</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Chain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Dense</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Dense</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Instantiate the model</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Note: The model is initialized with a neural network and the predictors and forcing terms</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">lh_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LinearHM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(m, (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:b</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:c</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.5f0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rng </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Random</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">default_rng</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Random</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">seed!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(rng, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ps, st </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> LuxCore</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">setup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(rng, lh_model)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Apply the model to the data</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ŷ, αst </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> LuxCore</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">apply</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(lh_model, ds_k, ps, st)</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.LoggingLoss" href="#EasyHybrid.LoggingLoss"><span class="jlbinding">EasyHybrid.LoggingLoss</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LoggingLoss</span></span></code></pre></div><p>A structure to define a logging loss function for hybrid models.</p><p><strong>Arguments</strong></p><ul><li><p><code>loss_types</code>: A vector of loss specifications (Symbol, Function or Tuple)</p><ul><li><p>Symbol: predefined loss, e.g. <code>:mse</code></p></li><li><p>Function: custom loss function, e.g. <code>custom_loss</code></p></li><li><p>Tuple: function with args/kwargs:</p><ul><li><p><code>(f, args)</code>: positional args, e.g. <code>(weighted_loss, (0.5,))</code></p></li><li><p><code>(f, kwargs)</code>: keyword args, e.g. <code>(scaled_loss, (scale=2.0,))</code></p></li><li><p><code>(f, args, kwargs)</code>: both, e.g. <code>(complex_loss, (0.5,), (scale=2.0,))</code></p></li></ul></li></ul></li><li><p><code>training_loss</code>: The loss specification to use during training (same format as above)</p></li><li><p><code>extra_loss</code>: Optional function <code>(ŷ; kwargs...) -&gt; scalar</code> to add to training loss (default: <code>nothing</code>)</p></li><li><p><code>agg</code>: Function to aggregate losses across targets, e.g. <code>sum</code> or <code>mean</code></p></li><li><p><code>train_mode</code>: If true, uses <code>training_loss</code>; otherwise uses <code>loss_types</code>.</p></li></ul><p><strong>Examples</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Simple predefined loss</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">logging </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LoggingLoss</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    loss_types</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:mse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:mae</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    training_loss</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:mse</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Custom loss function</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">custom_loss</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ŷ, y) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> mean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(abs2, ŷ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> y)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">logging </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LoggingLoss</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    loss_types</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:mse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, custom_loss],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    training_loss</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">custom_loss</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># With arguments/kwargs</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">weighted_loss</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ŷ, y, w) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> w </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> mean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(abs2, ŷ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> y)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">scaled_loss</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ŷ, y; scale</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> scale </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> mean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(abs2, ŷ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> y)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">logging </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LoggingLoss</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    loss_types</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:mse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, (weighted_loss, (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,)), (scaled_loss, (scale</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,))],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    training_loss</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(weighted_loss, (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.PerTarget" href="#EasyHybrid.PerTarget"><span class="jlbinding">EasyHybrid.PerTarget</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PerTarget</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(losses)</span></span></code></pre></div><p>A wrapper to indicate that a tuple of losses should be applied on a per-target basis.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.RbQ10_2p" href="#EasyHybrid.RbQ10_2p"><span class="jlbinding">EasyHybrid.RbQ10_2p</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RbQ10_2p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(forcing, targets, Q10)</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.RbQ10_2p-Tuple{Any, Any, Any}" href="#EasyHybrid.RbQ10_2p-Tuple{Any, Any, Any}"><span class="jlbinding">EasyHybrid.RbQ10_2p</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RbQ10_2p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(NN, predictors, forcing, targets, Q10)(ds_k)</span></span></code></pre></div><p><strong>Model definition <code>ŷ = Rb(αᵢ(t)) * Q10^((T(t) - T_ref)/10)</code></strong></p><p>ŷ (respiration rate) is computed as a function of the neural network output <code>Rb(αᵢ(t))</code> and the temperature <code>T(t)</code> adjusted by the reference temperature <code>T_ref</code> (default 15°C) using the Q10 temperature sensitivity factor. ````</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.RespirationRbQ10" href="#EasyHybrid.RespirationRbQ10"><span class="jlbinding">EasyHybrid.RespirationRbQ10</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RespirationRbQ10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(NN, predictors, forcing, targets, Q10)</span></span></code></pre></div><p>A linear hybrid model with a neural network <code>NN</code>, <code>predictors</code>, <code>targets</code> and <code>forcing</code> terms.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.RespirationRbQ10-Tuple{Any, Any, NamedTuple}" href="#EasyHybrid.RespirationRbQ10-Tuple{Any, Any, NamedTuple}"><span class="jlbinding">EasyHybrid.RespirationRbQ10</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RespirationRbQ10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(NN, predictors, forcing, targets, Q10)(ds_k)</span></span></code></pre></div><p><strong>Model definition <code>ŷ = Rb(αᵢ(t)) * Q10^((T(t) - T_ref)/10)</code></strong></p><p>ŷ (respiration rate) is computed as a function of the neural network output <code>Rb(αᵢ(t))</code> and the temperature <code>T(t)</code> adjusted by the reference temperature <code>T_ref</code> (default 15°C) using the Q10 temperature sensitivity factor. ````</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.Rs_components" href="#EasyHybrid.Rs_components"><span class="jlbinding">EasyHybrid.Rs_components</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Rs_components</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(NN, predictors, forcing, targets, Q10_het, Q10_root, Q10_myc)</span></span></code></pre></div><p>A linear hybrid model with a neural network <code>NN</code>, <code>predictors</code>, <code>targets</code> and <code>forcing</code> terms.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.Rs_components-Tuple{Any, Any, NamedTuple}" href="#EasyHybrid.Rs_components-Tuple{Any, Any, NamedTuple}"><span class="jlbinding">EasyHybrid.Rs_components</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Rs_components</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(NN, predictors, forcing, targets, Q10)(ds_k)</span></span></code></pre></div><p><strong>Model definition <code>ŷ = Rb(αᵢ(t)) * Q10^((T(t) - T_ref)/10)</code></strong></p><p>ŷ (respiration rate) is computed as a function of the neural network output <code>Rb(αᵢ(t))</code> and the temperature <code>T(t)</code> adjusted by the reference temperature <code>T_ref</code> (default 15°C) using the Q10 temperature sensitivity factor. ````</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.WrappedTuples" href="#EasyHybrid.WrappedTuples"><span class="jlbinding">EasyHybrid.WrappedTuples</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">WrappedTuples</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(vec</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Vector{&lt;:NamedTuple}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Wraps a vector of named tuples to allow dot-access to each field as a vector.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid._apply_loss" href="#EasyHybrid._apply_loss"><span class="jlbinding">EasyHybrid._apply_loss</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">_apply_loss</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ŷ, y, y_nan, loss_spec)</span></span></code></pre></div><p>Helper function to apply the appropriate loss function based on the specification type.</p><p><strong>Arguments</strong></p><ul><li><p><code>ŷ</code>: Predictions for a single target</p></li><li><p><code>y</code>: Target values for a single target</p></li><li><p><code>y_nan</code>: NaN mask for a single target</p></li><li><p><code>loss_spec</code>: Loss specification (Symbol, Function, or Tuple)</p></li></ul><p><strong>Returns</strong></p><ul><li>Computed loss value</li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid._compute_loss" href="#EasyHybrid._compute_loss"><span class="jlbinding">EasyHybrid._compute_loss</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">_compute_loss</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ŷ, y, y_nan, targets, loss_spec, agg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">_compute_loss</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ŷ, y, y_nan, targets, loss_types</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Vector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, agg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Compute the loss for the given predictions and targets using the specified training loss (or vector of losses) type and aggregation function.</p><p><strong>Arguments:</strong></p><ul><li><p><code>ŷ</code>: Predicted values.</p></li><li><p><code>y</code>: Target values.</p></li><li><p><code>y_nan</code>: Mask for NaN values.</p></li><li><p><code>targets</code>: The targets for which the loss is computed.</p></li><li><p><code>loss_spec</code>: The loss type to use during training, e.g., <code>:mse</code>.</p></li><li><p><code>loss_types::Vector</code>: A vector of loss types to compute, e.g., <code>[:mse, :mae]</code>.</p></li><li><p><code>agg::Function</code>: The aggregation function to apply to the computed losses, e.g., <code>sum</code> or <code>mean</code>.</p></li></ul><p>Returns a single loss value if <code>loss_spec</code> is provided, or a NamedTuple of losses for each type in <code>loss_types</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid._get_target_nan" href="#EasyHybrid._get_target_nan"><span class="jlbinding">EasyHybrid._get_target_nan</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">_get_target_nan</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y_nan, target)</span></span></code></pre></div><p>Helper function to extract target-specific values from <code>y_nan</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid._get_target_y" href="#EasyHybrid._get_target_y"><span class="jlbinding">EasyHybrid._get_target_y</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">_get_target_y</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y, target)</span></span></code></pre></div><p>Helper function to extract target-specific values from <code>y</code>, handling cases where <code>y</code> can be a tuple of <code>(y_obs, y_sigma)</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.build_parameter_matrix-Tuple{NamedTuple}" href="#EasyHybrid.build_parameter_matrix-Tuple{NamedTuple}"><span class="jlbinding">EasyHybrid.build_parameter_matrix</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">build_parameter_matrix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(parameter_defaults_and_bounds</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NamedTuple</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Build a ComponentArray matrix from a NamedTuple containing parameter defaults and bounds.</p><p>This function converts a NamedTuple where each value is a tuple of (default, lower, upper) bounds into a ComponentArray with named axes for easy parameter management in hybrid models.</p><p><strong>Arguments</strong></p><ul><li><code>parameter_defaults_and_bounds::NamedTuple</code>: A NamedTuple where each key is a parameter name and each value is a tuple of (default, lower, upper) for that parameter.</li></ul><p><strong>Returns</strong></p><ul><li><code>ComponentArray</code>: A 2D ComponentArray with: <ul><li><p>Row axis: Parameter names (from the NamedTuple keys)</p></li><li><p>Column axis: Bound types (:default, :lower, :upper)</p></li><li><p>Data: The parameter values organized in a matrix format</p></li></ul></li></ul><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Define parameter defaults and bounds</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">parameter_defaults_and_bounds </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    θ_s </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.464f0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.302f0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.700f0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),     </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Saturated water content [cm³/cm³]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    h_r </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1500.0f0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1500.0f0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1500.0f0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Pressure head at residual water content [cm]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    α   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.103f0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.01f0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">7.874f0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)),  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Shape parameter [cm⁻¹]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    n   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3.163f0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.100f0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20.000f0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)),  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Shape parameter [-]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Build the ComponentArray</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">parameter_matrix </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> build_parameter_matrix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(parameter_defaults_and_bounds)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Access specific parameter bounds</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">parameter_matrix</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">θ_s</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">default  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Get default value for θ_s</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">parameter_matrix[:, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:lower</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Get all lower bounds</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">parameter_matrix[:, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:upper</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Get all upper bounds</span></span></code></pre></div><p><strong>Notes</strong></p><ul><li><p>The function expects each value in the NamedTuple to be a tuple with exactly 3 elements</p></li><li><p>The order of bounds is always (default, lower, upper)</p></li><li><p>The resulting ComponentArray can be used for parameter optimization and constraint handling</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.build_parameters-Tuple{NamedTuple, DataType}" href="#EasyHybrid.build_parameters-Tuple{NamedTuple, DataType}"><span class="jlbinding">EasyHybrid.build_parameters</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">build_parameters</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(parameters</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NamedTuple</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, f</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DataType</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> AbstractHybridModel</span></span></code></pre></div><p>Constructs a parameter container from a named tuple of parameter bounds and wraps it in a user-defined subtype of <code>AbstractHybridModel</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>parameters::NamedTuple</code>: Named tuple where each entry is a tuple of (default, lower, upper) bounds for a parameter.</p></li><li><p><code>f::DataType</code>: A constructor for a subtype of <code>AbstractHybridModel</code> that takes a <code>ParameterContainer</code> as its argument.</p></li></ul><p><strong>Returns</strong></p><ul><li>An instance of the user-defined <code>AbstractHybridModel</code> subtype containing the parameter container.</li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.compute_loss-Tuple{LuxCore.AbstractLuxContainerLayer, Any, Any, Any}" href="#EasyHybrid.compute_loss-Tuple{LuxCore.AbstractLuxContainerLayer, Any, Any, Any}"><span class="jlbinding">EasyHybrid.compute_loss</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">compute_loss</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(HM, x, (y_t, y_nan), ps, st, logging</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LoggingLoss</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Main loss function for hybrid models that handles both training and evaluation modes.</p><p><strong>Arguments</strong></p><ul><li><p><code>HM</code>: The hybrid model (AbstractLuxContainerLayer or specific model type)</p></li><li><p><code>x</code>: Input data for the model</p></li><li><p><code>(y_t, y_nan)</code>: Tuple containing target values and NaN mask functions/arrays</p></li><li><p><code>ps</code>: Model parameters</p></li><li><p><code>st</code>: Model state</p></li><li><p><code>logging</code>: LoggingLoss configuration</p></li></ul><p><strong>Returns</strong></p><ul><li><p>In training mode (<code>logging.train_mode = true</code>):</p><ul><li><code>(loss_value, st)</code>: Single loss value and updated state</li></ul></li><li><p>In evaluation mode (<code>logging.train_mode = false</code>):</p><ul><li><code>(loss_values, st, ŷ)</code>: NamedTuple of losses, state and predictions</li></ul></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.constructNNModel-Tuple{Vector{Symbol}, Vector{Symbol}}" href="#EasyHybrid.constructNNModel-Tuple{Vector{Symbol}, Vector{Symbol}}"><span class="jlbinding">EasyHybrid.constructNNModel</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">constructNNModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(predictors, targets; hidden_layers, activation, scale_nn_outputs)</span></span></code></pre></div><p>Main constructor: <code>hidden_layers</code> can be either • a <code>Vector{Int}</code> of sizes, or • a <code>Chain</code> of hidden-layer <code>Dense</code> blocks.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.evec-Tuple{NamedTuple}" href="#EasyHybrid.evec-Tuple{NamedTuple}"><span class="jlbinding">EasyHybrid.evec</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><p>evec(nt::NamedTuple)</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.get_loss_value-Tuple{Any, Any, Symbol}" href="#EasyHybrid.get_loss_value-Tuple{Any, Any, Symbol}"><span class="jlbinding">EasyHybrid.get_loss_value</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">get_loss_value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(losses, loss_spec, agg)</span></span></code></pre></div><p>Extract loss value from losses based on the loss specification type.</p><p><strong>Arguments</strong></p><ul><li><p><code>losses</code>: NamedTuple containing loss values</p></li><li><p><code>loss_spec</code>: Loss specification (Symbol, Function or Tuple)</p></li><li><p><code>agg</code>: Aggregation function name as Symbol</p></li></ul><p><strong>Returns</strong></p><ul><li>Loss value for the specified loss function</li></ul><p><strong>Examples</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Symbol case</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">val </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> get_loss_value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(losses, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:mse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Function case</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">custom_loss</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ŷ, y) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> mean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(abs2, ŷ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> y)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">val </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> get_loss_value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(losses, custom_loss, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:mean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Tuple case</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">weighted_loss</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ŷ, y, w) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> w </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> mean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(abs2, ŷ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> y)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">val </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> get_loss_value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(losses, (weighted_loss, (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,)), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.get_prediction_target_names-Tuple{Any}" href="#EasyHybrid.get_prediction_target_names-Tuple{Any}"><span class="jlbinding">EasyHybrid.get_prediction_target_names</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">get_prediction_target_names</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hm)</span></span></code></pre></div><p>Utility function to extract predictor/forcing and target names from a hybrid model.</p><p><strong>Arguments:</strong></p><ul><li><code>hm</code>: The Hybrid Model</li></ul><p>Returns a tuple of (predictors_forcing, targets) names.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.initialize_plotting_observables-NTuple{9, Any}" href="#EasyHybrid.initialize_plotting_observables-NTuple{9, Any}"><span class="jlbinding">EasyHybrid.initialize_plotting_observables</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">initialize_plotting_observables</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(init_ŷ_train, init_ŷ_val, y_train, y_val, l_init_train, l_init_val, training_loss, agg, monitor_names, target_names)</span></span></code></pre></div><p>Initialize plotting observables for training visualization if the Makie extension is loaded.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.load_timeseries_netcdf-Tuple{AbstractString}" href="#EasyHybrid.load_timeseries_netcdf-Tuple{AbstractString}"><span class="jlbinding">EasyHybrid.load_timeseries_netcdf</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">load_timeseries_netcdf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(path</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; timedim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractString</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;time&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DataFrame</span></span></code></pre></div><p>Reads a NetCDF file where all data variables are 1D over the specified <code>timedim</code> and returns a tidy DataFrame with one row per time step.</p><ul><li><p>Only includes variables whose sole dimension is <code>timedim</code>.</p></li><li><p>Does not attempt to parse or convert time units; all columns are read as-is.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.loss_fn" href="#EasyHybrid.loss_fn"><span class="jlbinding">EasyHybrid.loss_fn</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">loss_fn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ŷ, y, y_nan, loss_type)</span></span></code></pre></div><p>Compute the loss for given predictions and targets using various loss specifications.</p><p><strong>Arguments</strong></p><ul><li><p><code>ŷ</code>: Predicted values</p></li><li><p><code>y</code>: Target values</p></li><li><p><code>y_nan</code>: Mask for NaN values</p></li><li><p><code>loss_type</code>: One of the following:</p><ul><li><p><code>Val(:rmse)</code>: Root Mean Square Error</p></li><li><p><code>Val(:mse)</code>: Mean Square Error</p></li><li><p><code>Val(:mae)</code>: Mean Absolute Error</p></li><li><p><code>Val(:pearson)</code>: Pearson correlation coefficient</p></li><li><p><code>Val(:r2)</code>: R-squared</p></li><li><p><code>Val(:pearsonLoss)</code>: 1 - Pearson correlation coefficient</p></li><li><p><code>Val(:nseLoss)</code>: 1 - NSE</p></li><li><p><code>::Function</code>: Custom loss function with signature <code>f(ŷ, y)</code></p></li><li><p><code>::Tuple{Function, Tuple}</code>: Custom loss with args <code>f(ŷ, y, args...)</code></p></li><li><p><code>::Tuple{Function, NamedTuple}</code>: Custom loss with kwargs <code>f(ŷ, y; kwargs...)</code></p></li><li><p><code>::Tuple{Function, Tuple, NamedTuple}</code>: Custom loss with both <code>f(ŷ, y, args...; kwargs...)</code></p></li></ul></li></ul><p><strong>Examples</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Predefined loss</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">loss </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> loss_fn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ŷ, y, y_nan, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:mse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Custom loss function</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">custom_loss</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ŷ, y) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> mean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(abs2, ŷ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> y)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">loss </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> loss_fn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ŷ, y, y_nan, custom_loss)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># With positional arguments</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">weighted_loss</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ŷ, y, w) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> w </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> mean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(abs2, ŷ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> y)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">loss </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> loss_fn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ŷ, y, y_nan, (weighted_loss, (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,)))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># With keyword arguments</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">scaled_loss</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ŷ, y; scale</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> scale </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> mean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(abs2, ŷ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> y)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">loss </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> loss_fn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ŷ, y, y_nan, (scaled_loss, (scale</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,)))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># With both args and kwargs</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">complex_loss</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ŷ, y, w; scale</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> scale </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> w </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> mean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(abs2, ŷ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> y)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">loss </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> loss_fn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ŷ, y, y_nan, (complex_loss, (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,), (scale</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,)))</span></span></code></pre></div><p>You can define additional predefined loss functions by adding more methods:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> EasyHybrid</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> loss_fn</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> EasyHybrid</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">loss_fn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ŷ, y, y_nan, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Val{:nse}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((ŷ[y_nan] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> y[y_nan])</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.^</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((y[y_nan] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> mean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y[y_nan]))</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.^</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.make_folds-Tuple{DataFrame}" href="#EasyHybrid.make_folds-Tuple{DataFrame}"><span class="jlbinding">EasyHybrid.make_folds</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">make_folds</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(df</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DataFrame</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; k</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, shuffle</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Vector{Int}</span></span></code></pre></div><p>Assigns each observation in the DataFrame <code>df</code> to one of <code>k</code> folds for cross-validation.</p><p><strong>Arguments</strong></p><ul><li><p><code>df::DataFrame</code>: The input DataFrame whose rows are to be split into folds.</p></li><li><p><code>k::Int=5</code>: Number of folds to create.</p></li><li><p><code>shuffle=true</code>: Whether to shuffle the data before assigning folds.</p></li></ul><p><strong>Returns</strong></p><ul><li><code>folds::Vector{Int}</code>: A vector of length <code>nrow(df)</code> where each entry is an integer in <code>1:k</code> indicating the fold assignment for that observation.</li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.prepare_data" href="#EasyHybrid.prepare_data"><span class="jlbinding">EasyHybrid.prepare_data</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">prepare_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hm, data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DataFrame</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">prepare_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hm, data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">KeyedArray</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">prepare_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hm, data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractDimArray</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">prepare_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hm, data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Tuple</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Prepare data for training by extracting predictor/forcing and target variables based on the hybrid model&#39;s configuration.</p><p><strong>Arguments:</strong></p><ul><li><p><code>hm</code>: The Hybrid Model</p></li><li><p><code>data</code>: The input data, which can be a DataFrame, KeyedArray, or DimensionalData array.</p></li></ul><p><strong>Returns:</strong></p><ul><li><p>If <code>data</code> is a DataFrame, KeyedArray returns a tuple of (predictors_forcing, targets) as KeyedArrays.</p></li><li><p>If <code>data</code> is an AbstractDimArray returns a tuple of (predictors_forcing, targets) of AbstractDimArrays.</p></li><li><p>If <code>data</code> is already a Tuple, it is returned as-is.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.prepare_hidden_chain-Tuple{Union{Chain, Vector{Int64}}, Int64, Int64}" href="#EasyHybrid.prepare_hidden_chain-Tuple{Union{Chain, Vector{Int64}}, Int64, Int64}"><span class="jlbinding">EasyHybrid.prepare_hidden_chain</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">prepare_hidden_chain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hidden_layers, in_dim, out_dim; activation, input_batchnorm</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Construct a neural network <code>Chain</code> for use in NN models.</p><p><strong>Arguments</strong></p><ul><li><p><code>hidden_layers::Union{Vector{Int}, Chain}</code>:</p><ul><li><p>If a <code>Vector{Int}</code>, specifies the sizes of each hidden layer. For example, <code>[32, 16]</code> creates two hidden layers with 32 and 16 units, respectively.</p></li><li><p>If a <code>Chain</code>, the user provides a pre-built chain of hidden layers (excluding input/output layers).</p></li></ul></li><li><p><code>in_dim::Int</code>: Number of input features (input dimension).</p></li><li><p><code>out_dim::Int</code>: Number of output features (output dimension).</p></li><li><p><code>activation</code>: Activation function to use in hidden layers (default: <code>tanh</code>).</p></li><li><p><code>input_batchnorm::Bool</code>: If <code>true</code>, applies a <code>BatchNorm</code> layer to the input (default: <code>false</code>).</p></li></ul><p><strong>Returns</strong></p><ul><li>A <code>Chain</code> object representing the full neural network, with the following structure: <ul><li><p>Optional input batch normalization (if <code>input_batchnorm=true</code>)</p></li><li><p>Input layer: <code>Dense(in_dim, h₁, activation)</code> where <code>h₁</code> is the first hidden size</p></li><li><p>Hidden layers: either user-supplied <code>Chain</code> or constructed from <code>hidden_layers</code></p></li><li><p>Output layer: <code>Dense(hₖ, out_dim)</code> where <code>hₖ</code> is the last hidden size</p></li></ul></li></ul><p>where <code>h₁</code> is the first hidden size and <code>hₖ</code> the last.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.scale_single_param-Tuple{Any, Any, AbstractHybridModel}" href="#EasyHybrid.scale_single_param-Tuple{Any, Any, AbstractHybridModel}"><span class="jlbinding">EasyHybrid.scale_single_param</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">scale_single_param</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(name, raw_val, parameters)</span></span></code></pre></div><p>Scale a single parameter using the sigmoid scaling function.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.scale_single_param_minmax-Tuple{Any, AbstractHybridModel}" href="#EasyHybrid.scale_single_param_minmax-Tuple{Any, AbstractHybridModel}"><span class="jlbinding">EasyHybrid.scale_single_param_minmax</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">scale_single_param_minmax</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(name, hm</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractHybridModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Scale a single parameter using the minmax scaling function.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.select_cols-Tuple{Any, Any, Any}" href="#EasyHybrid.select_cols-Tuple{Any, Any, Any}"><span class="jlbinding">EasyHybrid.select_cols</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><p>select_cols(df, predictors, x)</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.select_cols-Tuple{AxisKeys.KeyedArray, Any, Any}" href="#EasyHybrid.select_cols-Tuple{AxisKeys.KeyedArray, Any, Any}"><span class="jlbinding">EasyHybrid.select_cols</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><p>select_cols(df::KeyedArray, predictors, x)</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.select_predictors-Tuple{Any, Any}" href="#EasyHybrid.select_predictors-Tuple{Any, Any}"><span class="jlbinding">EasyHybrid.select_predictors</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><p>select_predictors(df, predictors)</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.select_predictors-Tuple{AxisKeys.KeyedArray, Any}" href="#EasyHybrid.select_predictors-Tuple{AxisKeys.KeyedArray, Any}"><span class="jlbinding">EasyHybrid.select_predictors</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><p>select_predictors(dk::KeyedArray, predictors)</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.select_variable-Tuple{AxisKeys.KeyedArray, Any}" href="#EasyHybrid.select_variable-Tuple{AxisKeys.KeyedArray, Any}"><span class="jlbinding">EasyHybrid.select_variable</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><p>select_variable(df::KeyedArray, x)</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.split_data" href="#EasyHybrid.split_data"><span class="jlbinding">EasyHybrid.split_data</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">split_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(data, hybridModel; split_by_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, shuffleobs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, split_data_at</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">split_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Union{DataFrame, KeyedArray}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, hybridModel; split_by_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, shuffleobs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, split_data_at</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, folds</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, val_fold</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">split_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractDimArray</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, hybridModel; split_by_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, shuffleobs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, split_data_at</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">split_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Tuple</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, hybridModel; split_by_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, shuffleobs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, split_data_at</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">split_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Tuple{Tuple, Tuple}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, hybridModel; kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Split data into training and validation sets, either randomly, by grouping by ID, or using external fold assignments.</p><p><strong>Arguments:</strong></p><ul><li><p><code>data</code>: The data to split, which can be a DataFrame, KeyedArray, AbstractDimArray, or Tuple</p></li><li><p><code>hybridModel</code>: The hybrid model object used for data preparation</p></li><li><p><code>split_by_id=nothing</code>: Either <code>nothing</code> for random splitting, a <code>Symbol</code> for column-based splitting, or an <code>AbstractVector</code> for custom ID-based splitting</p></li><li><p><code>shuffleobs=false</code>: Whether to shuffle observations during splitting</p></li><li><p><code>split_data_at=0.8</code>: Ratio of data to use for training</p></li><li><p><code>folds</code>: Vector or column name of fold assignments (1..k), one per sample/column for k-fold cross-validation</p></li><li><p><code>val_fold</code>: The validation fold to use when <code>folds</code> is provided</p></li></ul><p><strong>Behavior:</strong></p><ul><li><p>For DataFrame/KeyedArray: Supports random splitting, ID-based splitting, and external fold assignments</p></li><li><p>For AbstractDimArray/Tuple: Random splitting only after data preparation</p></li><li><p>For pre-split Tuple{Tuple, Tuple}: Returns input unchanged</p></li></ul><p><strong>Returns:</strong></p><ul><li><code>((x_train, y_train), (x_val, y_val))</code>: Tuple containing training and validation data pairs</li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.split_data-Tuple{DataFrame, Any, Any, Any}" href="#EasyHybrid.split_data-Tuple{DataFrame, Any, Any, Any}"><span class="jlbinding">EasyHybrid.split_data</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><p>split_data(df::DataFrame, target, xvars, seqID; f=0.8, batchsize=32, shuffle=true, partial=true)</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.split_data-Tuple{DataFrame, Any, Any}" href="#EasyHybrid.split_data-Tuple{DataFrame, Any, Any}"><span class="jlbinding">EasyHybrid.split_data</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><p>split_data(df::DataFrame, target, xvars; f=0.8, batchsize=32, shuffle=true, partial=true)</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.toNamedTuple-Tuple{AxisKeys.KeyedArray, Symbol}" href="#EasyHybrid.toNamedTuple-Tuple{AxisKeys.KeyedArray, Symbol}"><span class="jlbinding">EasyHybrid.toNamedTuple</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><p>toNamedTuple(ka::KeyedArray, variable::Symbol) Extract a single variable from a KeyedArray and return it as a vector.</p><p><strong>Arguments:</strong></p><ul><li><p><code>ka</code>: The KeyedArray to unpack</p></li><li><p><code>variable</code>: Symbol representing the variable to extract</p></li></ul><p><strong>Returns:</strong></p><ul><li>Vector containing the variable data</li></ul><p><strong>Example:</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Extract just SW_IN from a KeyedArray</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sw_in </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> toNamedTuple</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ds_keyed, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:SW_IN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.toNamedTuple-Tuple{AxisKeys.KeyedArray, Vector{Symbol}}" href="#EasyHybrid.toNamedTuple-Tuple{AxisKeys.KeyedArray, Vector{Symbol}}"><span class="jlbinding">EasyHybrid.toNamedTuple</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><p>toNamedTuple(ka::KeyedArray, variables::Vector{Symbol}) Extract specified variables from a KeyedArray and return them as a NamedTuple of vectors.</p><p><strong>Arguments:</strong></p><ul><li><p><code>ka</code>: The KeyedArray to unpack</p></li><li><p><code>variables</code>: Vector of symbols representing the variables to extract</p></li></ul><p><strong>Returns:</strong></p><ul><li>NamedTuple with variable names as keys and vectors as values</li></ul><p><strong>Example:</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Extract SW_IN and TA from a KeyedArray</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> toNamedTuple</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ds_keyed, [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:SW_IN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:TA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sw_in </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SW_IN</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ta </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">TA</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.toNamedTuple-Tuple{AxisKeys.KeyedArray}" href="#EasyHybrid.toNamedTuple-Tuple{AxisKeys.KeyedArray}"><span class="jlbinding">EasyHybrid.toNamedTuple</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><p>toNamedTuple(ka::KeyedArray) Extract all variables from a KeyedArray and return them as a NamedTuple of vectors.</p><p><strong>Arguments:</strong></p><ul><li><code>ka</code>: The KeyedArray to unpack</li></ul><p><strong>Returns:</strong></p><ul><li>NamedTuple with all variable names as keys and vectors as values</li></ul><p><strong>Example:</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Extract all variables from a KeyedArray</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> toNamedTuple</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ds_keyed)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Access individual variables</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sw_in </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SW_IN</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ta </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">TA</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">nee </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NEE</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.to_keyedArray" href="#EasyHybrid.to_keyedArray"><span class="jlbinding">EasyHybrid.to_keyedArray</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><p>tokeyedArray(dfg::Union{Vector,GroupedDataFrame{DataFrame}}, vars=All())</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.to_keyedArray-Tuple{DataFrame}" href="#EasyHybrid.to_keyedArray-Tuple{DataFrame}"><span class="jlbinding">EasyHybrid.to_keyedArray</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><p>tokeyedArray(df::DataFrame)</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.train-Tuple{Any, Any, Any}" href="#EasyHybrid.train-Tuple{Any, Any, Any}"><span class="jlbinding">EasyHybrid.train</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">train</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hybridModel, data, save_ps; nepochs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, batchsize</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, opt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Adam</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), patience</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">typemax</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Int),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      file_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, loss_types</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:mse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:r2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], training_loss</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:mse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, agg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sum, train_from</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      random_seed</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">161803</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, yscale</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">log10, monitor_names</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[], return_model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:best</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      plotting</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, show_progress</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, hybrid_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">randstring</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Train a hybrid model using the provided data and save the training process to a file in JLD2 format. Default output file is <code>trained_model.jld2</code> at the current working directory under <code>output_tmp</code>.</p><p><strong>Arguments:</strong></p><ul><li><p><code>hybridModel</code>: The hybrid model to be trained.</p></li><li><p><code>data</code>: The training data, either a single DataFrame, a single KeyedArray, or a tuple of KeyedArrays.</p></li><li><p><code>save_ps</code>: A tuple of physical parameters to save during training.</p></li></ul><p><strong>Core Training Parameters:</strong></p><ul><li><p><code>nepochs</code>: Number of training epochs (default: 200).</p></li><li><p><code>batchsize</code>: Size of the training batches (default: 10).</p></li><li><p><code>opt</code>: The optimizer to use for training (default: Adam(0.01)).</p></li><li><p><code>patience</code>: The number of epochs to wait before early stopping (default: <code>typemax(Int)</code> -&gt; no early stopping).</p></li></ul><p><strong>Loss and Evaluation:</strong></p><ul><li><p><code>training_loss</code>: The loss type to use during training (default: <code>:mse</code>).</p></li><li><p><code>loss_types</code>: A vector of loss types to compute during training (default: <code>[:mse, :r2]</code>). The first entry is used for plotting in the dynamic trainboard. This loss can be increasing (e.g. NSE) or decreasing (e.g. RMSE).</p></li><li><p><code>agg</code>: The aggregation function to apply to the computed losses (default: <code>sum</code>).</p></li></ul><p><strong>Data Handling (passed via kwargs):</strong></p><ul><li><p><code>shuffleobs</code>: Whether to shuffle the training data (default: false).</p></li><li><p><code>split_by_id</code>: Column name or function to split data by ID (default: nothing -&gt; no ID-based splitting).</p></li><li><p><code>split_data_at</code>: Fraction of data to use for training when splitting (default: 0.8).</p></li><li><p><code>folds</code>: Vector or column name of fold assignments (1..k), one per sample/column for k-fold cross-validation (default: nothing).</p></li><li><p><code>val_fold</code>: The validation fold to use when <code>folds</code> is provided (default: nothing).</p></li></ul><p><strong>Training State and Reproducibility:</strong></p><ul><li><p><code>train_from</code>: A tuple of physical parameters and state to start training from or an output of <code>train</code> (default: nothing -&gt; new training).</p></li><li><p><code>random_seed</code>: The random seed to use for training (default: 161803).</p></li></ul><p><strong>Output and Monitoring:</strong></p><ul><li><p><code>file_name</code>: The name of the file to save the training process (default: nothing -&gt; &quot;trained_model.jld2&quot;).</p></li><li><p><code>hybrid_name</code>: Name identifier for the hybrid model (default: randomly generated 10-character string).</p></li><li><p><code>return_model</code>: The model to return: <code>:best</code> for the best model, <code>:final</code> for the final model (default: <code>:best</code>).</p></li><li><p><code>monitor_names</code>: A vector of monitor names to track during training (default: <code>[]</code>).</p></li><li><p><code>folder_to_save</code>: Additional folder name string to append to output path (default: &quot;&quot;).</p></li></ul><p><strong>Visualization and UI:</strong></p><ul><li><p><code>plotting</code>: Whether to generate plots during training (default: true).</p></li><li><p><code>show_progress</code>: Whether to show progress bars during training (default: true).</p></li><li><p><code>yscale</code>: The scale to apply to the y-axis for plotting (default: <code>log10</code>).</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="EasyHybrid.@hybrid-Tuple{Any, Vararg{Any}}" href="#EasyHybrid.@hybrid-Tuple{Any, Vararg{Any}}"><span class="jlbinding">EasyHybrid.@hybrid</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@hybrid</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ModelName α β γ</span></span></code></pre></div><p>Macro to define hybrid model structs with arbitrary numbers of physical parameters.</p><p>This defines a struct with:</p><ul><li><p>Default fields: <code>NN</code> (neural network), <code>predictors</code>, <code>forcing</code>, <code>targets</code>.</p></li><li><p>Additional physical parameters, i.e., <code>α β γ</code>.</p></li></ul><p><strong>Examples</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@hybrid</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MyModel α β γ</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@hybrid</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> FluidModel (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:viscosity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:density</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@hybrid</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SimpleModel </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:a</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :b</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EarthyScience/EasyHybrid.jl" target="_blank" rel="noreferrer">source</a><!--]--></span></details></div></div></main><footer class="VPDocFooter" data-v-83890dd9 data-v-4f9813fa><!--[--><!--]--><div class="edit-info" data-v-4f9813fa><div class="edit-link" data-v-4f9813fa><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://https://github.com/EarthyScience/EasyHybrid.jl/edit/main/docs/src/api.md" target="_blank" rel="noreferrer" data-v-4f9813fa><!--[--><span class="vpi-square-pen edit-link-icon" data-v-4f9813fa></span> Edit this page<!--]--></a></div><!----></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-4f9813fa><span class="visually-hidden" id="doc-footer-aria-label" data-v-4f9813fa>Pager</span><div class="pager" data-v-4f9813fa><a class="VPLink link pager-link prev" href="/EasyHybrid.jl/previews/PR216/research/overview" data-v-4f9813fa><!--[--><span class="desc" data-v-4f9813fa>Previous page</span><span class="title" data-v-4f9813fa>Overview</span><!--]--></a></div><div class="pager" data-v-4f9813fa><!----></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-a9a9e638 data-v-c970a860><div class="container" data-v-c970a860><p class="message" data-v-c970a860>Made with <a href="https://luxdl.github.io/DocumenterVitepress.jl/stable/" target="_blank"><strong>DocumenterVitepress.jl</strong></a> <br></p><p class="copyright" data-v-c970a860>© Copyright 2025. Lazaro Alonso.</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"api.md\":\"BttXPYMS\",\"get_started.md\":\"Dd6I2s9R\",\"index.md\":\"QUUBXuD7\",\"research_overview.md\":\"xiMYunaW\",\"tutorials_exponential_res.md\":\"BJQQj0q2\",\"tutorials_folds.md\":\"CKpYL1Ba\",\"tutorials_hyperparameter_tuning.md\":\"hAP7FXd0\",\"tutorials_losses.md\":\"DKIbFnFi\",\"tutorials_slurm.md\":\"FOig1yyq\",\"tutorials_synthetic_respiration.md\":\"-8JCNvaz\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"EasyHybrid.jl\",\"description\":\"Documentation for EasyHybrid.jl\",\"base\":\"/EasyHybrid.jl/previews/PR216/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"outline\":\"deep\",\"logo\":{\"src\":\"/logo_sq.png\",\"width\":24,\"height\":24},\"search\":{\"provider\":\"local\",\"options\":{\"detailedView\":true}},\"nav\":[{\"text\":\"Home\",\"link\":\"/index\"},{\"text\":\"Get Started\",\"link\":\"/get_started\"},{\"text\":\"Tutorial\",\"collapsed\":false,\"items\":[{\"text\":\"Exponential Response\",\"link\":\"/tutorials/exponential_res\"},{\"text\":\"Hyperparameter Tuning\",\"link\":\"/tutorials/hyperparameter_tuning\"},{\"text\":\"Slurm\",\"link\":\"/tutorials/slurm\"},{\"text\":\"Cross-validation\",\"link\":\"/tutorials/folds\"},{\"text\":\"Loss Functions\",\"link\":\"/tutorials/losses\"}]},{\"text\":\"Research\",\"collapsed\":false,\"items\":[{\"text\":\"Overview\",\"link\":\"/research/overview\"}]},{\"text\":\"API\",\"link\":\"/api\"},{\"component\":\"VersionPicker\"}],\"sidebar\":[{\"text\":\"Home\",\"link\":\"/index\"},{\"text\":\"Get Started\",\"link\":\"/get_started\"},{\"text\":\"Tutorial\",\"collapsed\":false,\"items\":[{\"text\":\"Exponential Response\",\"link\":\"/tutorials/exponential_res\"},{\"text\":\"Hyperparameter Tuning\",\"link\":\"/tutorials/hyperparameter_tuning\"},{\"text\":\"Slurm\",\"link\":\"/tutorials/slurm\"},{\"text\":\"Cross-validation\",\"link\":\"/tutorials/folds\"},{\"text\":\"Loss Functions\",\"link\":\"/tutorials/losses\"}]},{\"text\":\"Research\",\"collapsed\":false,\"items\":[{\"text\":\"Overview\",\"link\":\"/research/overview\"}]},{\"text\":\"API\",\"link\":\"/api\"}],\"editLink\":{\"pattern\":\"https://https://github.com/EarthyScience/EasyHybrid.jl/edit/main/docs/src/:path\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/EarthyScience/EasyHybrid.jl\"}],\"footer\":{\"message\":\"Made with <a href=\\\"https://luxdl.github.io/DocumenterVitepress.jl/stable/\\\" target=\\\"_blank\\\"><strong>DocumenterVitepress.jl</strong></a> <br>\",\"copyright\":\"© Copyright 2025. Lazaro Alonso.\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>